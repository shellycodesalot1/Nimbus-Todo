{"ast":null,"code":"// msal.js\nimport { PublicClientApplication } from \"@azure/msal-browser\";\nconst msalConfig = {\n  auth: {\n    clientId: \"6438927f-5f93-41f7-80aa-d6516cd19114\",\n    // <-- your clientId is fine\n    authority: \"https://login.microsoftonline.com/common\",\n    redirectUri: \"http://localhost:3000\"\n  },\n  cache: {\n    cacheLocation: \"sessionStorage\",\n    storeAuthStateInCookie: false\n  }\n};\nexport const msalInstance = new PublicClientApplication(msalConfig);\nexport const loginRequest = {\n  scopes: [\"User.Read\"]\n};\n\n// ðŸ› ï¸ FIX: Initialize before trying to login\nexport const handleMicrosoftLogin = async () => {\n  try {\n    await msalInstance.initialize(); // <-- ðŸ”¥ this line is critical\n    const response = await msalInstance.loginPopup(loginRequest);\n    return response.account;\n  } catch (error) {\n    console.error(\"Microsoft login failed:\", error);\n    throw error;\n  }\n};","map":{"version":3,"names":["PublicClientApplication","msalConfig","auth","clientId","authority","redirectUri","cache","cacheLocation","storeAuthStateInCookie","msalInstance","loginRequest","scopes","handleMicrosoftLogin","initialize","response","loginPopup","account","error","console"],"sources":["/Users/marieezoua/Documents/School Files/GSU/Spring 2025/CSC 4311 - Cloud Computing/Project/Nimbus-Todo/src/msal.js"],"sourcesContent":["// msal.js\nimport { PublicClientApplication } from \"@azure/msal-browser\";\n\nconst msalConfig = {\n  auth: {\n    clientId: \"6438927f-5f93-41f7-80aa-d6516cd19114\", // <-- your clientId is fine\n    authority: \"https://login.microsoftonline.com/common\",\n    redirectUri: \"http://localhost:3000\",\n  },\n  cache: {\n    cacheLocation: \"sessionStorage\",\n    storeAuthStateInCookie: false,\n  },\n};\n\nexport const msalInstance = new PublicClientApplication(msalConfig);\n\nexport const loginRequest = {\n  scopes: [\"User.Read\"],\n};\n\n// ðŸ› ï¸ FIX: Initialize before trying to login\nexport const handleMicrosoftLogin = async () => {\n  try {\n    await msalInstance.initialize(); // <-- ðŸ”¥ this line is critical\n    const response = await msalInstance.loginPopup(loginRequest);\n    return response.account;\n  } catch (error) {\n    console.error(\"Microsoft login failed:\", error);\n    throw error;\n  }\n};\n"],"mappings":"AAAA;AACA,SAASA,uBAAuB,QAAQ,qBAAqB;AAE7D,MAAMC,UAAU,GAAG;EACjBC,IAAI,EAAE;IACJC,QAAQ,EAAE,sCAAsC;IAAE;IAClDC,SAAS,EAAE,0CAA0C;IACrDC,WAAW,EAAE;EACf,CAAC;EACDC,KAAK,EAAE;IACLC,aAAa,EAAE,gBAAgB;IAC/BC,sBAAsB,EAAE;EAC1B;AACF,CAAC;AAED,OAAO,MAAMC,YAAY,GAAG,IAAIT,uBAAuB,CAACC,UAAU,CAAC;AAEnE,OAAO,MAAMS,YAAY,GAAG;EAC1BC,MAAM,EAAE,CAAC,WAAW;AACtB,CAAC;;AAED;AACA,OAAO,MAAMC,oBAAoB,GAAG,MAAAA,CAAA,KAAY;EAC9C,IAAI;IACF,MAAMH,YAAY,CAACI,UAAU,CAAC,CAAC,CAAC,CAAC;IACjC,MAAMC,QAAQ,GAAG,MAAML,YAAY,CAACM,UAAU,CAACL,YAAY,CAAC;IAC5D,OAAOI,QAAQ,CAACE,OAAO;EACzB,CAAC,CAAC,OAAOC,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;IAC/C,MAAMA,KAAK;EACb;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}