{"ast":null,"code":"import * as msal from '@azure/msal-browser';\n\n// üîê B2C Config\nconst b2cConfig = {\n  tenantName: \"nimbustodo1\",\n  clientId: \"6438927f-5f93-41f7-80aa-d6516cd19114\",\n  signUpSignInPolicy: \"B2C_1_nimbussignup_signin\",\n  authorityDomain: \"b2clogin.com\"\n};\n\n// üß≠ Authority URL\nconst authorityBase = `https://${b2cConfig.tenantName}.${b2cConfig.authorityDomain}`;\nconst authority = `${authorityBase}/${b2cConfig.tenantName}.onmicrosoft.com/${b2cConfig.signUpSignInPolicy}`;\n\n// ‚öôÔ∏è MSAL Configuration\nconst msalConfig = {\n  auth: {\n    clientId: b2cConfig.clientId,\n    authority,\n    knownAuthorities: [`${b2cConfig.tenantName}.${b2cConfig.authorityDomain}`],\n    redirectUri: \"http://localhost:3000\",\n    postLogoutRedirectUri: \"http://localhost:3000\",\n    navigateToLoginRequestUrl: true\n  },\n  cache: {\n    cacheLocation: \"localStorage\",\n    storeAuthStateInCookie: false\n  },\n  system: {\n    allowRedirectInIframe: true,\n    loggerOptions: {\n      loggerCallback: (level, message) => console.log(`MSAL: ${message}`),\n      logLevel: msal.LogLevel.Warning\n    }\n  }\n};\n\n// üîë Login Scopes\nexport const loginRequest = {\n  scopes: [\"openid\", \"profile\", \"offline_access\"]\n};\n\n// üöÄ Create and export MSAL instance\nexport const msalInstance = new msal.PublicClientApplication(msalConfig);\n\n// ‚úÖ Helper for initialization\nconst initializeMsal = async () => {\n  // If already initialized, don't reinitialize\n  if (!msalInstance.getAllAccounts()) {\n    try {\n      await msalInstance.initialize();\n      console.log(\"MSAL Initialized successfully.\");\n    } catch (error) {\n      console.error(\"Error initializing MSAL:\", error);\n    }\n  }\n};\n\n// üîê Login Helper with initialization check\nexport const handleMicrosoftLogin = async () => {\n  try {\n    // Ensure MSAL is initialized before use\n    await initializeMsal();\n    const accounts = msalInstance.getAllAccounts();\n    if (accounts.length > 0) {\n      msalInstance.setActiveAccount(accounts[0]);\n      return {\n        name: accounts[0].name,\n        username: accounts[0].username\n      };\n    }\n    const response = await msalInstance.loginPopup(loginRequest);\n    const account = response.account;\n    msalInstance.setActiveAccount(account);\n    return {\n      name: account.name,\n      username: account.username\n    };\n  } catch (error) {\n    console.error(\"‚ùå Microsoft login failed:\", error);\n    throw error;\n  }\n};","map":{"version":3,"names":["msal","b2cConfig","tenantName","clientId","signUpSignInPolicy","authorityDomain","authorityBase","authority","msalConfig","auth","knownAuthorities","redirectUri","postLogoutRedirectUri","navigateToLoginRequestUrl","cache","cacheLocation","storeAuthStateInCookie","system","allowRedirectInIframe","loggerOptions","loggerCallback","level","message","console","log","logLevel","LogLevel","Warning","loginRequest","scopes","msalInstance","PublicClientApplication","initializeMsal","getAllAccounts","initialize","error","handleMicrosoftLogin","accounts","length","setActiveAccount","name","username","response","loginPopup","account"],"sources":["/Users/shelliciabethune/Nimbus-To-Do/Nimbus-Todo/src/azure.js"],"sourcesContent":["import * as msal from '@azure/msal-browser';\n\n// üîê B2C Config\nconst b2cConfig = {\n  tenantName: \"nimbustodo1\",\n  clientId: \"6438927f-5f93-41f7-80aa-d6516cd19114\",\n  signUpSignInPolicy: \"B2C_1_nimbussignup_signin\",\n  authorityDomain: \"b2clogin.com\"\n};\n\n// üß≠ Authority URL\nconst authorityBase = `https://${b2cConfig.tenantName}.${b2cConfig.authorityDomain}`;\nconst authority = `${authorityBase}/${b2cConfig.tenantName}.onmicrosoft.com/${b2cConfig.signUpSignInPolicy}`;\n\n// ‚öôÔ∏è MSAL Configuration\nconst msalConfig = {\n  auth: {\n    clientId: b2cConfig.clientId,\n    authority,\n    knownAuthorities: [`${b2cConfig.tenantName}.${b2cConfig.authorityDomain}`],\n    redirectUri: \"http://localhost:3000\",\n    postLogoutRedirectUri: \"http://localhost:3000\",\n    navigateToLoginRequestUrl: true\n  },\n  cache: {\n    cacheLocation: \"localStorage\",\n    storeAuthStateInCookie: false\n  },\n  system: {\n    allowRedirectInIframe: true,\n    loggerOptions: {\n      loggerCallback: (level, message) => console.log(`MSAL: ${message}`),\n      logLevel: msal.LogLevel.Warning\n    }\n  }\n};\n\n// üîë Login Scopes\nexport const loginRequest = {\n  scopes: [\"openid\", \"profile\", \"offline_access\"]\n};\n\n// üöÄ Create and export MSAL instance\nexport const msalInstance = new msal.PublicClientApplication(msalConfig);\n\n// ‚úÖ Helper for initialization\nconst initializeMsal = async () => {\n  // If already initialized, don't reinitialize\n  if (!msalInstance.getAllAccounts()) {\n    try {\n      await msalInstance.initialize();\n      console.log(\"MSAL Initialized successfully.\");\n    } catch (error) {\n      console.error(\"Error initializing MSAL:\", error);\n    }\n  }\n};\n\n// üîê Login Helper with initialization check\nexport const handleMicrosoftLogin = async () => {\n  try {\n    // Ensure MSAL is initialized before use\n    await initializeMsal();\n\n    const accounts = msalInstance.getAllAccounts();\n    if (accounts.length > 0) {\n      msalInstance.setActiveAccount(accounts[0]);\n      return {\n        name: accounts[0].name,\n        username: accounts[0].username\n      };\n    }\n\n    const response = await msalInstance.loginPopup(loginRequest);\n    const account = response.account;\n    msalInstance.setActiveAccount(account);\n\n    return {\n      name: account.name,\n      username: account.username\n    };\n  } catch (error) {\n    console.error(\"‚ùå Microsoft login failed:\", error);\n    throw error;\n  }\n};\n\n"],"mappings":"AAAA,OAAO,KAAKA,IAAI,MAAM,qBAAqB;;AAE3C;AACA,MAAMC,SAAS,GAAG;EAChBC,UAAU,EAAE,aAAa;EACzBC,QAAQ,EAAE,sCAAsC;EAChDC,kBAAkB,EAAE,2BAA2B;EAC/CC,eAAe,EAAE;AACnB,CAAC;;AAED;AACA,MAAMC,aAAa,GAAG,WAAWL,SAAS,CAACC,UAAU,IAAID,SAAS,CAACI,eAAe,EAAE;AACpF,MAAME,SAAS,GAAG,GAAGD,aAAa,IAAIL,SAAS,CAACC,UAAU,oBAAoBD,SAAS,CAACG,kBAAkB,EAAE;;AAE5G;AACA,MAAMI,UAAU,GAAG;EACjBC,IAAI,EAAE;IACJN,QAAQ,EAAEF,SAAS,CAACE,QAAQ;IAC5BI,SAAS;IACTG,gBAAgB,EAAE,CAAC,GAAGT,SAAS,CAACC,UAAU,IAAID,SAAS,CAACI,eAAe,EAAE,CAAC;IAC1EM,WAAW,EAAE,uBAAuB;IACpCC,qBAAqB,EAAE,uBAAuB;IAC9CC,yBAAyB,EAAE;EAC7B,CAAC;EACDC,KAAK,EAAE;IACLC,aAAa,EAAE,cAAc;IAC7BC,sBAAsB,EAAE;EAC1B,CAAC;EACDC,MAAM,EAAE;IACNC,qBAAqB,EAAE,IAAI;IAC3BC,aAAa,EAAE;MACbC,cAAc,EAAEA,CAACC,KAAK,EAAEC,OAAO,KAAKC,OAAO,CAACC,GAAG,CAAC,SAASF,OAAO,EAAE,CAAC;MACnEG,QAAQ,EAAEzB,IAAI,CAAC0B,QAAQ,CAACC;IAC1B;EACF;AACF,CAAC;;AAED;AACA,OAAO,MAAMC,YAAY,GAAG;EAC1BC,MAAM,EAAE,CAAC,QAAQ,EAAE,SAAS,EAAE,gBAAgB;AAChD,CAAC;;AAED;AACA,OAAO,MAAMC,YAAY,GAAG,IAAI9B,IAAI,CAAC+B,uBAAuB,CAACvB,UAAU,CAAC;;AAExE;AACA,MAAMwB,cAAc,GAAG,MAAAA,CAAA,KAAY;EACjC;EACA,IAAI,CAACF,YAAY,CAACG,cAAc,CAAC,CAAC,EAAE;IAClC,IAAI;MACF,MAAMH,YAAY,CAACI,UAAU,CAAC,CAAC;MAC/BX,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC;IAC/C,CAAC,CAAC,OAAOW,KAAK,EAAE;MACdZ,OAAO,CAACY,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;IAClD;EACF;AACF,CAAC;;AAED;AACA,OAAO,MAAMC,oBAAoB,GAAG,MAAAA,CAAA,KAAY;EAC9C,IAAI;IACF;IACA,MAAMJ,cAAc,CAAC,CAAC;IAEtB,MAAMK,QAAQ,GAAGP,YAAY,CAACG,cAAc,CAAC,CAAC;IAC9C,IAAII,QAAQ,CAACC,MAAM,GAAG,CAAC,EAAE;MACvBR,YAAY,CAACS,gBAAgB,CAACF,QAAQ,CAAC,CAAC,CAAC,CAAC;MAC1C,OAAO;QACLG,IAAI,EAAEH,QAAQ,CAAC,CAAC,CAAC,CAACG,IAAI;QACtBC,QAAQ,EAAEJ,QAAQ,CAAC,CAAC,CAAC,CAACI;MACxB,CAAC;IACH;IAEA,MAAMC,QAAQ,GAAG,MAAMZ,YAAY,CAACa,UAAU,CAACf,YAAY,CAAC;IAC5D,MAAMgB,OAAO,GAAGF,QAAQ,CAACE,OAAO;IAChCd,YAAY,CAACS,gBAAgB,CAACK,OAAO,CAAC;IAEtC,OAAO;MACLJ,IAAI,EAAEI,OAAO,CAACJ,IAAI;MAClBC,QAAQ,EAAEG,OAAO,CAACH;IACpB,CAAC;EACH,CAAC,CAAC,OAAON,KAAK,EAAE;IACdZ,OAAO,CAACY,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;IACjD,MAAMA,KAAK;EACb;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}